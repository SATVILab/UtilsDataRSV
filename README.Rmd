---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# UtilsDataRSV

<!-- badges: start -->
[![R-CMD-check](https://github.com/SATVILab/UtilsDataRSV/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/SATVILab/UtilsDataRSV/actions/workflows/R-CMD-check.yaml)
[![Codecov test coverage](https://codecov.io/gh/SATVILab/UtilsDataRSV/graph/badge.svg)](https://codecov.io/gh/SATVILab/UtilsDataRSV)
<!-- badges: end -->

UtilsDataRSV is an R package that provides utility functions for common data pre-processing tasks. It helps streamline workflows by offering tools to quickly inspect data, fix common import errors, and perform group-based data operations.

## Features
 
- **Data Inspection**: View unique column entries and group-based data slices
- **Data Cleaning**: Fix Excel decimal symbol errors from locale mismatches
- **Data Manipulation**: Safe list crossing and group-based filtering utilities

## Installation

You can install UtilsDataRSV from [GitHub](https://github.com/SATVILab/UtilsDataRSV) with:

```{r , eval = FALSE}
if (!require("remotes", quietly = TRUE)) install.packages("remotes")
remotes::install_github("SATVILab/UtilsDataRSV")
```

## Examples

```{r }
library(UtilsDataRSV)
```

### View unique column entries

`view_cols()` displays a random sample of unique entries for each column in a dataframe, useful for quickly understanding data structure and content.

```{r view_cols}
data("mtcars")
view_cols(mtcars)
```

### View data slices by group

`view_slice()` shows a subset of entries per group, a convenient wrapper around `dplyr::group_by()` and `dplyr::slice()`.

```{r view_slice}
data("cars")
cars[, "grp"] <- rep(letters[1:5], each = 10)
view_slice(cars, group = "grp", n_slice = 2)
```

### Fix Excel decimal symbol errors

`convert_character_to_number_correctly()` fixes errors when Excel exports numbers using comma as the decimal separator but R expects a period.

```{r convert_character_to_number_correctly}
# vector of data (as if from Excel)
x <- c("1,32", "1", "0,23", "3,23E-2", NA)
x_corrected <- convert_character_to_number_correctly(x = x)
# original data alongside corrected data
tibble::tibble(original = x, corrected = x_corrected)
```

## Additional Functions

- `cross_df_safe()`: Safely cross lists into a dataframe, handling multi-length elements without unexpected expansion
- `filter_based_on_mean_grp_value()`: Filter data to keep only groups with the smallest or largest mean value
