<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Safely cross lists — cross_df_safe • UtilsDataRSV</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Safely cross lists — cross_df_safe"><meta name="description" content="Returns the cartesian of all its elements in a list
as a dataframe, with one combination per row."><meta property="og:description" content="Returns the cartesian of all its elements in a list
as a dataframe, with one combination per row."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">UtilsDataRSV</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Safely cross lists</h1>

      <div class="d-none name"><code>cross_df_safe.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Returns the cartesian of all its elements in a list
as a dataframe, with one combination per row.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">cross_df_safe</span><span class="op">(</span><span class="va">.l</span>, .filter <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg--l">.l<a class="anchor" aria-label="anchor" href="#arg--l"></a></dt>
<dd><p>A list of lists or atomic vectors (or, a dataframe).</p></dd>


<dt id="arg--filter">.filter<a class="anchor" aria-label="anchor" href="#arg--filter"></a></dt>
<dd><p>function.
A predicate function that takes the same number of arguments
as the number of variables to be combined.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A dataframe with the same number of rows as</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Elements in the list to be crossed
such as <code>list(1, 2:3)</code> keep
their multi-length elements in one combination
(i.e. one dataframe row).
That is the sense in which is "safe",
as it behaves as expected in that
not only lists are "guarded", i.e. not joined together.</p>
<p>The function `purrr::cross` returns an error
in this case, whilst `purrr::cross` piped
`purrr::map_df(tibble::as_tibble)` w
creates two combinations (two dataframe rows)
from the second list element above.
One could wrap the second element in a list, but
that adds an extra layer when accessing the element
in the combination.</p>
<p>Another advantage</p>
<p>See examples for a demonstration.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># cross_df_safe automatically</span></span></span>
<span class="r-in"><span><span class="co"># "protects" non-list list elements</span></span></span>
<span class="r-in"><span><span class="va">to_cross_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  V1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  V2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># returns an error</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/cross.html" class="external-link">cross_df</a></span><span class="op">(</span><span class="va">to_cross_list</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>`cross_df()` was deprecated in purrr 1.0.0.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Please use `tidyr::expand_grid()` instead.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> See &lt;https://github.com/tidyverse/purrr/issues/768&gt;.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>`cross()` was deprecated in purrr 1.0.0.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Please use `tidyr::expand_grid()` instead.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> See &lt;https://github.com/tidyverse/purrr/issues/768&gt;.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> The deprecated feature was likely used in the <span style="color: #0000BB;">purrr</span> package.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>   Please report the issue at <span style="color: #0000BB; font-style: italic;">&lt;https://github.com/tidyverse/purrr/issues&gt;</span>.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Error in recycle_columns(x, .rows, lengths) : </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Tibble columns must have compatible sizes.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">•</span> Size 4: Column `V1`.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">•</span> Size 6: Column `V2`.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Only values of size one are recycled.</span>
<span class="r-in"><span><span class="co"># can avoid this by wrapping each to-cross</span></span></span>
<span class="r-in"><span><span class="co"># element's elements in lists,</span></span></span>
<span class="r-in"><span><span class="co"># but then the crossed dataframe</span></span></span>
<span class="r-in"><span><span class="co"># has second column's elements</span></span></span>
<span class="r-in"><span><span class="co"># each be lists</span></span></span>
<span class="r-in"><span><span class="va">to_cross_list_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  V1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  V2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">4</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cross_df_purrr</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/cross.html" class="external-link">cross_df</a></span><span class="op">(</span><span class="va">to_cross_list_list</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cross_df_purrr</span><span class="op">$</span><span class="va">V2</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]][[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]][[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[3]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[3]][[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 4 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[4]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[4]][[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 4 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># returns a four-row dataframe, where</span></span></span>
<span class="r-in"><span><span class="co"># second column has elements of lengths 1, 1, 2 and 2</span></span></span>
<span class="r-in"><span><span class="co"># that are not lists</span></span></span>
<span class="r-in"><span><span class="va">cross_df_sf</span> <span class="op">&lt;-</span> <span class="fu">cross_df_safe</span><span class="op">(</span><span class="va">to_cross_list</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cross_df_sf</span><span class="op">$</span><span class="va">V2</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[3]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 4 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[4]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 4 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># the above is more natural to work with</span></span></span>
<span class="r-in"><span><span class="co"># no element in a combination</span></span></span>
<span class="r-in"><span><span class="co"># is needlessly wrapped inside an unnamed list of length 1</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="va">to_cross_list_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  V1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"a"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"b"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  V2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span> <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"b"</span> <span class="op">=</span> <span class="st">"d"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">cross_df_std</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/cross.html" class="external-link">cross_df</a></span><span class="op">(</span><span class="va">to_cross_list_list</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cross_df_sf</span> <span class="op">&lt;-</span> <span class="fu">cross_df_safe</span><span class="op">(</span><span class="va">to_cross_list_list</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># purr:cross_df needlessly places each element of V2</span></span></span>
<span class="r-in"><span><span class="co"># (e.g. list("a" = "c")) in its own list:</span></span></span>
<span class="r-in"><span><span class="va">cross_df_std</span><span class="op">$</span><span class="va">V2</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   a   a   b   b </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "c" "c" "d" "d" </span>
<span class="r-in"><span><span class="co"># the above means that to refer to the element, you need to</span></span></span>
<span class="r-in"><span><span class="co"># add an extra set of brackets:</span></span></span>
<span class="r-in"><span><span class="co"># cross_df_std$V2[[1]][[1]]</span></span></span>
<span class="r-in"><span><span class="co"># in this case, however,cross_df_safe flattens the list by one level:</span></span></span>
<span class="r-in"><span><span class="va">cross_df_sf</span><span class="op">$</span><span class="va">V2</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   a </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "c" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   a </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "c" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[3]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   b </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "d" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[4]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   b </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "d" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># so that you can refer to individual elements more succinctly:</span></span></span>
<span class="r-in"><span><span class="va">cross_df_sf</span><span class="op">$</span><span class="va">V2</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   a </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "c" </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Miguel Julio Rodo.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

